help:
    just -l

build:
    tsup --format esm --outDir dist/
    tsup  --format esm --outDir dist/ --dts-only
    tools/fix-dist-extensions.sh

build-check:
    #!/usr/bin/env sh

    MAX_CPUS=$(cat /proc/cpuinfo | grep 'cpu cores' | perl -pe 's/.*(\d+)/$1/g' | sort -u)

    echo build-check-eslint-cjs build-check-eslint-js build-check-eslint-jsx build-check-eslint-mjs build-check-eslint-ts build-check-eslint-tsx \
         | shuf \
         | xargs -P${MAX_CPUS} -I% sh -c 'pnpm just %'

build-check-eslint-cjs:
    eslint -c tests/configs/eslint.config.cjs.mjs tests/files/cjs/*.cjs

build-check-eslint-js:
    eslint -c tests/configs/eslint.config.js.mjs tests/files/js/*.js tests/files/cjs/*.cjs tests/files/mjs/*.mjs

build-check-eslint-jsx:
    eslint -c tests/configs/eslint.config.jsx.mjs tests/files/jsx/*.jsx

build-check-eslint-mjs:
    eslint -c tests/configs/eslint.config.mjs.mjs tests/files/mjs/*.mjs

build-check-eslint-ts:
    eslint -c tests/configs/eslint.config.ts.mjs tests/files/ts/*.ts

build-check-eslint-tsx:
    eslint -c tests/configs/eslint.config.tsx.mjs tests/files/tsx/*.tsx

lint:
    eslint --fix src/ types/
    prettier -w .
    pnpm exec just --fmt --unstable

type-check:
    tsc --noEmit
